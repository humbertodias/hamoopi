#include "input.h"

void MovSlots_P1() {
    P[1].bt_slot[16] = P[1].bt_slot[15];
    P[1].bt_slot[15] = P[1].bt_slot[14];
    P[1].bt_slot[14] = P[1].bt_slot[13];
    P[1].bt_slot[13] = P[1].bt_slot[12];
    P[1].bt_slot[12] = P[1].bt_slot[11];
    P[1].bt_slot[11] = P[1].bt_slot[10];
    P[1].bt_slot[10] = P[1].bt_slot[9];
    P[1].bt_slot[9] = P[1].bt_slot[8];
    P[1].bt_slot[8] = P[1].bt_slot[7];
    P[1].bt_slot[7] = P[1].bt_slot[6];
    P[1].bt_slot[6] = P[1].bt_slot[5];
    P[1].bt_slot[5] = P[1].bt_slot[4];
    P[1].bt_slot[4] = P[1].bt_slot[3];
    P[1].bt_slot[3] = P[1].bt_slot[2];
    P[1].bt_slot[2] = P[1].bt_slot[1];
    P[1].bt_slot[1] = 0;

    P[1].slot[16] = P[1].slot[15];
    P[1].slot[15] = P[1].slot[14];
    P[1].slot[14] = P[1].slot[13];
    P[1].slot[13] = P[1].slot[12];
    P[1].slot[12] = P[1].slot[11];
    P[1].slot[11] = P[1].slot[10];
    P[1].slot[10] = P[1].slot[9];
    P[1].slot[9] = P[1].slot[8];
    P[1].slot[8] = P[1].slot[7];
    P[1].slot[7] = P[1].slot[6];
    P[1].slot[6] = P[1].slot[5];
    P[1].slot[5] = P[1].slot[4];
    P[1].slot[4] = P[1].slot[3];
    P[1].slot[3] = P[1].slot[2];
    P[1].slot[2] = P[1].slot[1];
    P[1].slot[1] = 0;

    P[1].t_slot[16] = P[1].t_slot[15];
    P[1].t_slot[15] = P[1].t_slot[14];
    P[1].t_slot[14] = P[1].t_slot[13];
    P[1].t_slot[13] = P[1].t_slot[12];
    P[1].t_slot[12] = P[1].t_slot[11];
    P[1].t_slot[11] = P[1].t_slot[10];
    P[1].t_slot[10] = P[1].t_slot[9];
    P[1].t_slot[9] = P[1].t_slot[8];
    P[1].t_slot[8] = P[1].t_slot[7];
    P[1].t_slot[7] = P[1].t_slot[6];
    P[1].t_slot[6] = P[1].t_slot[5];
    P[1].t_slot[5] = P[1].t_slot[4];
    P[1].t_slot[4] = P[1].t_slot[3];
    P[1].t_slot[3] = P[1].t_slot[2];
    P[1].t_slot[2] = P[1].t_slot[1];
    P[1].t_slot[1] = 0;
}

void MovSlots_P2() {
    P[2].bt_slot[16] = P[2].bt_slot[15];
    P[2].bt_slot[15] = P[2].bt_slot[14];
    P[2].bt_slot[14] = P[2].bt_slot[13];
    P[2].bt_slot[13] = P[2].bt_slot[12];
    P[2].bt_slot[12] = P[2].bt_slot[11];
    P[2].bt_slot[11] = P[2].bt_slot[10];
    P[2].bt_slot[10] = P[2].bt_slot[9];
    P[2].bt_slot[9] = P[2].bt_slot[8];
    P[2].bt_slot[8] = P[2].bt_slot[7];
    P[2].bt_slot[7] = P[2].bt_slot[6];
    P[2].bt_slot[6] = P[2].bt_slot[5];
    P[2].bt_slot[5] = P[2].bt_slot[4];
    P[2].bt_slot[4] = P[2].bt_slot[3];
    P[2].bt_slot[3] = P[2].bt_slot[2];
    P[2].bt_slot[2] = P[2].bt_slot[1];
    P[2].bt_slot[1] = 0;

    P[2].slot[16] = P[2].slot[15];
    P[2].slot[15] = P[2].slot[14];
    P[2].slot[14] = P[2].slot[13];
    P[2].slot[13] = P[2].slot[12];
    P[2].slot[12] = P[2].slot[11];
    P[2].slot[11] = P[2].slot[10];
    P[2].slot[10] = P[2].slot[9];
    P[2].slot[9] = P[2].slot[8];
    P[2].slot[8] = P[2].slot[7];
    P[2].slot[7] = P[2].slot[6];
    P[2].slot[6] = P[2].slot[5];
    P[2].slot[5] = P[2].slot[4];
    P[2].slot[4] = P[2].slot[3];
    P[2].slot[3] = P[2].slot[2];
    P[2].slot[2] = P[2].slot[1];
    P[2].slot[1] = 0;

    P[2].t_slot[16] = P[2].t_slot[15];
    P[2].t_slot[15] = P[2].t_slot[14];
    P[2].t_slot[14] = P[2].t_slot[13];
    P[2].t_slot[13] = P[2].t_slot[12];
    P[2].t_slot[12] = P[2].t_slot[11];
    P[2].t_slot[11] = P[2].t_slot[10];
    P[2].t_slot[10] = P[2].t_slot[9];
    P[2].t_slot[9] = P[2].t_slot[8];
    P[2].t_slot[8] = P[2].t_slot[7];
    P[2].t_slot[7] = P[2].t_slot[6];
    P[2].t_slot[6] = P[2].t_slot[5];
    P[2].t_slot[5] = P[2].t_slot[4];
    P[2].t_slot[4] = P[2].t_slot[3];
    P[2].t_slot[3] = P[2].t_slot[2];
    P[2].t_slot[2] = P[2].t_slot[1];
    P[2].t_slot[1] = 0;
}

void zeraListaDeInputs() {
    int i;
    for (i = 0; i < 17; i++) {
        // Fixed: changed i<=17 to i<17 to avoid array out-of-bounds
        P[1].slot[i] = 0;
        P[1].bt_slot[i] = 0;
        P[1].t_slot[i] = 0;
        P[1].ticks_4slot = 0;
        P[2].slot[i] = 0;
        P[2].bt_slot[i] = 0;
        P[2].t_slot[i] = 0;
        P[2].ticks_4slot = 0;
    }
    for (i = 1; i <= 2; i++) {
        P[i].key_UP_pressed = 0;
        P[i].key_UP_released = 0;
        P[i].key_UP_hold = 0;
        P[i].key_UP_status = 0;
        P[i].key_DOWN_pressed = 0;
        P[i].key_DOWN_released = 0;
        P[i].key_DOWN_hold = 0;
        P[i].key_DOWN_status = 0;
        P[i].key_LEFT_pressed = 0;
        P[i].key_LEFT_released = 0;
        P[i].key_LEFT_hold = 0;
        P[i].key_LEFT_status = 0;
        P[i].key_RIGHT_pressed = 0;
        P[i].key_RIGHT_released = 0;
        P[i].key_RIGHT_hold = 0;
        P[i].key_RIGHT_status = 0;
        P[i].key_BT1_pressed = 0;
        P[i].key_BT1_released = 0;
        P[i].key_BT1_hold = 0;
        P[i].key_BT1_status = 0;
        P[i].key_BT2_pressed = 0;
        P[i].key_BT2_released = 0;
        P[i].key_BT2_hold = 0;
        P[i].key_BT2_status = 0;
        P[i].key_BT3_pressed = 0;
        P[i].key_BT3_released = 0;
        P[i].key_BT3_hold = 0;
        P[i].key_BT3_status = 0;
        P[i].key_BT4_pressed = 0;
        P[i].key_BT4_released = 0;
        P[i].key_BT4_hold = 0;
        P[i].key_BT4_status = 0;
        P[i].key_BT5_pressed = 0;
        P[i].key_BT5_released = 0;
        P[i].key_BT5_hold = 0;
        P[i].key_BT5_status = 0;
        P[i].key_BT6_pressed = 0;
        P[i].key_BT6_released = 0;
        P[i].key_BT6_hold = 0;
        P[i].key_BT6_status = 0;
        P[i].key_SELECT_pressed = 0;
        P[i].key_SELECT_released = 0;
        P[i].key_SELECT_hold = 0;
        P[i].key_SELECT_status = 0;
        P[i].key_START_pressed = 0;
        P[i].key_START_released = 0;
        P[i].key_START_hold = 0;
        P[i].key_START_status = 0;
    }
}

void check_keys_P1() {
    if (mouse_b & 1) {
        if (key_Mouse_L_pressed == 1 && key_Mouse_L_hold == 0) {
            key_Mouse_L_hold = 1;
            key_Mouse_L_pressed = 0;
        }
        if (key_Mouse_L_pressed == 0 && key_Mouse_L_hold == 0) { key_Mouse_L_pressed = 1; }
    }
    if (!(mouse_b & 1)) {
        if (key_Mouse_L_released == 1) {
            key_Mouse_L_released = 0;
            key_Mouse_L_pressed = 0;
            key_Mouse_L_hold = 0;
        }
        if (key_Mouse_L_pressed > 0 || key_Mouse_L_hold > 0) { key_Mouse_L_released = 1; }
    }
    if (key_Mouse_L_pressed == 0 && key_Mouse_L_hold == 0 && key_Mouse_L_released == 0) { key_Mouse_L_status = 0; }
    if (key_Mouse_L_pressed == 1) { key_Mouse_L_status = 1; }
    if (key_Mouse_L_hold == 1) { key_Mouse_L_status = 2; }
    if (key_Mouse_L_released == 1) { key_Mouse_L_status = 3; }
    if (mouse_b & 2) {
        if (key_Mouse_R_pressed == 1 && key_Mouse_R_hold == 0) {
            key_Mouse_R_hold = 1;
            key_Mouse_R_pressed = 0;
        }
        if (key_Mouse_R_pressed == 0 && key_Mouse_R_hold == 0) { key_Mouse_R_pressed = 1; }
    }
    if (!(mouse_b & 2)) {
        if (key_Mouse_R_released == 1) {
            key_Mouse_R_released = 0;
            key_Mouse_R_pressed = 0;
            key_Mouse_R_hold = 0;
        }
        if (key_Mouse_R_pressed > 0 || key_Mouse_R_hold > 0) { key_Mouse_R_released = 1; }
    }
    if (key_Mouse_R_pressed == 0 && key_Mouse_R_hold == 0 && key_Mouse_R_released == 0) { key_Mouse_R_status = 0; }
    if (key_Mouse_R_pressed == 1) { key_Mouse_R_status = 1; }
    if (key_Mouse_R_hold == 1) { key_Mouse_R_status = 2; }
    if (key_Mouse_R_released == 1) { key_Mouse_R_status = 3; }
    if (key[KEY_F1]) {
        if (key_F1_pressed == 1 && key_F1_hold == 0) {
            key_F1_hold = 1;
            key_F1_pressed = 0;
        }
        if (key_F1_pressed == 0 && key_F1_hold == 0) { key_F1_pressed = 1; }
    }
    if (!key[KEY_F1]) {
        if (key_F1_released == 1) {
            key_F1_released = 0;
            key_F1_pressed = 0;
            key_F1_hold = 0;
        }
        if (key_F1_pressed > 0 || key_F1_hold > 0) { key_F1_released = 1; }
    }
    if (key_F1_pressed == 0 && key_F1_hold == 0 && key_F1_released == 0) { key_F1_status = 0; }
    if (key_F1_pressed == 1) { key_F1_status = 1; }
    if (key_F1_hold == 1) { key_F1_status = 2; }
    if (key_F1_released == 1) { key_F1_status = 3; }
    if (key[KEY_F2]) {
        if (key_F2_pressed == 1 && key_F2_hold == 0) {
            key_F2_hold = 1;
            key_F2_pressed = 0;
        }
        if (key_F2_pressed == 0 && key_F2_hold == 0) { key_F2_pressed = 1; }
    }
    if (!key[KEY_F2]) {
        if (key_F2_released == 1) {
            key_F2_released = 0;
            key_F2_pressed = 0;
            key_F2_hold = 0;
        }
        if (key_F2_pressed > 0 || key_F2_hold > 0) { key_F2_released = 1; }
    }
    if (key_F2_pressed == 0 && key_F2_hold == 0 && key_F2_released == 0) { key_F2_status = 0; }
    if (key_F2_pressed == 1) { key_F2_status = 1; }
    if (key_F2_hold == 1) { key_F2_status = 2; }
    if (key_F2_released == 1) { key_F2_status = 3; }
    if (key[KEY_F3]) {
        if (key_F3_pressed == 1 && key_F3_hold == 0) {
            key_F3_hold = 1;
            key_F3_pressed = 0;
        }
        if (key_F3_pressed == 0 && key_F3_hold == 0) { key_F3_pressed = 1; }
    }
    if (!key[KEY_F3]) {
        if (key_F3_released == 1) {
            key_F3_released = 0;
            key_F3_pressed = 0;
            key_F3_hold = 0;
        }
        if (key_F3_pressed > 0 || key_F3_hold > 0) { key_F3_released = 1; }
    }
    if (key_F3_pressed == 0 && key_F3_hold == 0 && key_F3_released == 0) { key_F3_status = 0; }
    if (key_F3_pressed == 1) { key_F3_status = 1; }
    if (key_F3_hold == 1) { key_F3_status = 2; }
    if (key_F3_released == 1) { key_F3_status = 3; }
    if (key[KEY_F4]) {
        if (key_F4_pressed == 1 && key_F4_hold == 0) {
            key_F4_hold = 1;
            key_F4_pressed = 0;
        }
        if (key_F4_pressed == 0 && key_F4_hold == 0) { key_F4_pressed = 1; }
    }
    if (!key[KEY_F4]) {
        if (key_F4_released == 1) {
            key_F4_released = 0;
            key_F4_pressed = 0;
            key_F4_hold = 0;
        }
        if (key_F4_pressed > 0 || key_F4_hold > 0) { key_F4_released = 1; }
    }
    if (key_F4_pressed == 0 && key_F4_hold == 0 && key_F4_released == 0) { key_F4_status = 0; }
    if (key_F4_pressed == 1) { key_F4_status = 1; }
    if (key_F4_hold == 1) { key_F4_status = 2; }
    if (key_F4_released == 1) { key_F4_status = 3; }
    //WASD sao utilizados no editor
    if (key[KEY_W]) {
        if (P[1].key_W_pressed == 1 && P[1].key_W_hold == 0) {
            P[1].key_W_hold = 1;
            P[1].key_W_pressed = 0;
        }
        if (P[1].key_W_pressed == 0 && P[1].key_W_hold == 0) { P[1].key_W_pressed = 1; }
    }
    if (!key[KEY_W]) {
        if (P[1].key_W_released == 1) {
            P[1].key_W_released = 0;
            P[1].key_W_pressed = 0;
            P[1].key_W_hold = 0;
        }
        if (P[1].key_W_pressed > 0 || P[1].key_W_hold > 0) { P[1].key_W_released = 1; }
    }
    if (P[1].key_W_pressed == 0 && P[1].key_W_hold == 0 && P[1].key_W_released == 0) { P[1].key_W_status = 0; }
    if (P[1].key_W_pressed == 1) { P[1].key_W_status = 1; }
    if (P[1].key_W_hold == 1) { P[1].key_W_status = 2; }
    if (P[1].key_W_released == 1) { P[1].key_W_status = 3; }
    if (key[KEY_S]) {
        if (P[1].key_S_pressed == 1 && P[1].key_S_hold == 0) {
            P[1].key_S_hold = 1;
            P[1].key_S_pressed = 0;
        }
        if (P[1].key_S_pressed == 0 && P[1].key_S_hold == 0) { P[1].key_S_pressed = 1; }
    }
    if (!key[KEY_S]) {
        if (P[1].key_S_released == 1) {
            P[1].key_S_released = 0;
            P[1].key_S_pressed = 0;
            P[1].key_S_hold = 0;
        }
        if (P[1].key_S_pressed > 0 || P[1].key_S_hold > 0) { P[1].key_S_released = 1; }
    }
    if (P[1].key_S_pressed == 0 && P[1].key_S_hold == 0 && P[1].key_S_released == 0) { P[1].key_S_status = 0; }
    if (P[1].key_S_pressed == 1) { P[1].key_S_status = 1; }
    if (P[1].key_S_hold == 1) { P[1].key_S_status = 2; }
    if (P[1].key_S_released == 1) { P[1].key_S_status = 3; }
    if (key[KEY_A]) {
        if (P[1].key_A_pressed == 1 && P[1].key_A_hold == 0) {
            P[1].key_A_hold = 1;
            P[1].key_A_pressed = 0;
        }
        if (P[1].key_A_pressed == 0 && P[1].key_A_hold == 0) { P[1].key_A_pressed = 1; }
    }
    if (!key[KEY_A]) {
        if (P[1].key_A_released == 1) {
            P[1].key_A_released = 0;
            P[1].key_A_pressed = 0;
            P[1].key_A_hold = 0;
        }
        if (P[1].key_A_pressed > 0 || P[1].key_A_hold > 0) { P[1].key_A_released = 1; }
    }
    if (P[1].key_A_pressed == 0 && P[1].key_A_hold == 0 && P[1].key_A_released == 0) { P[1].key_A_status = 0; }
    if (P[1].key_A_pressed == 1) { P[1].key_A_status = 1; }
    if (P[1].key_A_hold == 1) { P[1].key_A_status = 2; }
    if (P[1].key_A_released == 1) { P[1].key_A_status = 3; }
    if (key[KEY_D]) {
        if (P[1].key_D_pressed == 1 && P[1].key_D_hold == 0) {
            P[1].key_D_hold = 1;
            P[1].key_D_pressed = 0;
        }
        if (P[1].key_D_pressed == 0 && P[1].key_D_hold == 0) { P[1].key_D_pressed = 1; }
    }
    if (!key[KEY_D]) {
        if (P[1].key_D_released == 1) {
            P[1].key_D_released = 0;
            P[1].key_D_pressed = 0;
            P[1].key_D_hold = 0;
        }
        if (P[1].key_D_pressed > 0 || P[1].key_D_hold > 0) { P[1].key_D_released = 1; }
    }
    if (P[1].key_D_pressed == 0 && P[1].key_D_hold == 0 && P[1].key_D_released == 0) { P[1].key_D_status = 0; }
    if (P[1].key_D_pressed == 1) { P[1].key_D_status = 1; }
    if (P[1].key_D_hold == 1) { P[1].key_D_status = 2; }
    if (P[1].key_D_released == 1) { P[1].key_D_status = 3; }

    if (desabilita_players == 0 && P[1].Pode_Mexer == 1) {
        if (P1_UP) {
            if (P[1].key_UP_pressed == 1 && P[1].key_UP_hold == 0) {
                P[1].key_UP_hold = 1;
                P[1].key_UP_pressed = 0;
            }
            if (P[1].key_UP_pressed == 0 && P[1].key_UP_hold == 0) { P[1].key_UP_pressed = 1; }
        }
        if (!P1_UP) {
            if (P[1].key_UP_released == 1) {
                P[1].key_UP_released = 0;
                P[1].key_UP_pressed = 0;
                P[1].key_UP_hold = 0;
            }
            if (P[1].key_UP_pressed > 0 || P[1].key_UP_hold > 0) { P[1].key_UP_released = 1; }
        }
        if (P[1].key_UP_pressed == 0 && P[1].key_UP_hold == 0 && P[1].key_UP_released == 0) { P[1].key_UP_status = 0; }
        if (P[1].key_UP_pressed == 1) { P[1].key_UP_status = 1; }
        if (P[1].key_UP_hold == 1) { P[1].key_UP_status = 2; }
        if (P[1].key_UP_released == 1) { P[1].key_UP_status = 3; }
        if (P1_DOWN) {
            if (P[1].key_DOWN_pressed == 1 && P[1].key_DOWN_hold == 0) {
                P[1].key_DOWN_hold = 1;
                P[1].key_DOWN_pressed = 0;
            }
            if (P[1].key_DOWN_pressed == 0 && P[1].key_DOWN_hold == 0) { P[1].key_DOWN_pressed = 1; }
        }
        if (!P1_DOWN) {
            if (P[1].key_DOWN_released == 1) {
                P[1].key_DOWN_released = 0;
                P[1].key_DOWN_pressed = 0;
                P[1].key_DOWN_hold = 0;
            }
            if (P[1].key_DOWN_pressed > 0 || P[1].key_DOWN_hold > 0) { P[1].key_DOWN_released = 1; }
        }
        if (P[1].key_DOWN_pressed == 0 && P[1].key_DOWN_hold == 0 && P[1].key_DOWN_released == 0) {
            P[1].key_DOWN_status = 0;
        }
        if (P[1].key_DOWN_pressed == 1) { P[1].key_DOWN_status = 1; }
        if (P[1].key_DOWN_hold == 1) { P[1].key_DOWN_status = 2; }
        if (P[1].key_DOWN_released == 1) { P[1].key_DOWN_status = 3; }
        if (P1_LEFT) {
            if (P[1].key_LEFT_pressed == 1 && P[1].key_LEFT_hold == 0) {
                P[1].key_LEFT_hold = 1;
                P[1].key_LEFT_pressed = 0;
            }
            if (P[1].key_LEFT_pressed == 0 && P[1].key_LEFT_hold == 0) { P[1].key_LEFT_pressed = 1; }
        }
        if (!P1_LEFT) {
            if (P[1].key_LEFT_released == 1) {
                P[1].key_LEFT_released = 0;
                P[1].key_LEFT_pressed = 0;
                P[1].key_LEFT_hold = 0;
            }
            if (P[1].key_LEFT_pressed > 0 || P[1].key_LEFT_hold > 0) { P[1].key_LEFT_released = 1; }
        }
        if (P[1].key_LEFT_pressed == 0 && P[1].key_LEFT_hold == 0 && P[1].key_LEFT_released == 0) {
            P[1].key_LEFT_status = 0;
        }
        if (P[1].key_LEFT_pressed == 1) { P[1].key_LEFT_status = 1; }
        if (P[1].key_LEFT_hold == 1) { P[1].key_LEFT_status = 2; }
        if (P[1].key_LEFT_released == 1) { P[1].key_LEFT_status = 3; }
        if (P1_RIGHT) {
            if (P[1].key_RIGHT_pressed == 1 && P[1].key_RIGHT_hold == 0) {
                P[1].key_RIGHT_hold = 1;
                P[1].key_RIGHT_pressed = 0;
            }
            if (P[1].key_RIGHT_pressed == 0 && P[1].key_RIGHT_hold == 0) { P[1].key_RIGHT_pressed = 1; }
        }
        if (!P1_RIGHT) {
            if (P[1].key_RIGHT_released == 1) {
                P[1].key_RIGHT_released = 0;
                P[1].key_RIGHT_pressed = 0;
                P[1].key_RIGHT_hold = 0;
            }
            if (P[1].key_RIGHT_pressed > 0 || P[1].key_RIGHT_hold > 0) { P[1].key_RIGHT_released = 1; }
        }
        if (P[1].key_RIGHT_pressed == 0 && P[1].key_RIGHT_hold == 0 && P[1].key_RIGHT_released == 0) {
            P[1].key_RIGHT_status = 0;
        }
        if (P[1].key_RIGHT_pressed == 1) { P[1].key_RIGHT_status = 1; }
        if (P[1].key_RIGHT_hold == 1) { P[1].key_RIGHT_status = 2; }
        if (P[1].key_RIGHT_released == 1) { P[1].key_RIGHT_status = 3; }
        if (P1_BT1) {
            if (P[1].key_BT1_pressed == 1 && P[1].key_BT1_hold == 0) {
                P[1].key_BT1_hold = 1;
                P[1].key_BT1_pressed = 0;
            }
            if (P[1].key_BT1_pressed == 0 && P[1].key_BT1_hold == 0) { P[1].key_BT1_pressed = 1; }
        }
        if (!P1_BT1) {
            if (P[1].key_BT1_released == 1) {
                P[1].key_BT1_released = 0;
                P[1].key_BT1_pressed = 0;
                P[1].key_BT1_hold = 0;
            }
            if (P[1].key_BT1_pressed > 0 || P[1].key_BT1_hold > 0) { P[1].key_BT1_released = 1; }
        }
        if (P[1].key_BT1_pressed == 0 && P[1].key_BT1_hold == 0 && P[1].key_BT1_released == 0) {
            P[1].key_BT1_status = 0;
        }
        if (P[1].key_BT1_pressed == 1) { P[1].key_BT1_status = 1; }
        if (P[1].key_BT1_hold == 1) { P[1].key_BT1_status = 2; }
        if (P[1].key_BT1_released == 1) { P[1].key_BT1_status = 3; }
        if (P1_BT2) {
            if (P[1].key_BT2_pressed == 1 && P[1].key_BT2_hold == 0) {
                P[1].key_BT2_hold = 1;
                P[1].key_BT2_pressed = 0;
            }
            if (P[1].key_BT2_pressed == 0 && P[1].key_BT2_hold == 0) { P[1].key_BT2_pressed = 1; }
        }
        if (!P1_BT2) {
            if (P[1].key_BT2_released == 1) {
                P[1].key_BT2_released = 0;
                P[1].key_BT2_pressed = 0;
                P[1].key_BT2_hold = 0;
            }
            if (P[1].key_BT2_pressed > 0 || P[1].key_BT2_hold > 0) { P[1].key_BT2_released = 1; }
        }
        if (P[1].key_BT2_pressed == 0 && P[1].key_BT2_hold == 0 && P[1].key_BT2_released == 0) {
            P[1].key_BT2_status = 0;
        }
        if (P[1].key_BT2_pressed == 1) { P[1].key_BT2_status = 1; }
        if (P[1].key_BT2_hold == 1) { P[1].key_BT2_status = 2; }
        if (P[1].key_BT2_released == 1) { P[1].key_BT2_status = 3; }
        if (P1_BT3) {
            if (P[1].key_BT3_pressed == 1 && P[1].key_BT3_hold == 0) {
                P[1].key_BT3_hold = 1;
                P[1].key_BT3_pressed = 0;
            }
            if (P[1].key_BT3_pressed == 0 && P[1].key_BT3_hold == 0) { P[1].key_BT3_pressed = 1; }
        }
        if (!P1_BT3) {
            if (P[1].key_BT3_released == 1) {
                P[1].key_BT3_released = 0;
                P[1].key_BT3_pressed = 0;
                P[1].key_BT3_hold = 0;
            }
            if (P[1].key_BT3_pressed > 0 || P[1].key_BT3_hold > 0) { P[1].key_BT3_released = 1; }
        }
        if (P[1].key_BT3_pressed == 0 && P[1].key_BT3_hold == 0 && P[1].key_BT3_released == 0) {
            P[1].key_BT3_status = 0;
        }
        if (P[1].key_BT3_pressed == 1) { P[1].key_BT3_status = 1; }
        if (P[1].key_BT3_hold == 1) { P[1].key_BT3_status = 2; }
        if (P[1].key_BT3_released == 1) { P[1].key_BT3_status = 3; }
        if (P1_BT4) {
            if (P[1].key_BT4_pressed == 1 && P[1].key_BT4_hold == 0) {
                P[1].key_BT4_hold = 1;
                P[1].key_BT4_pressed = 0;
            }
            if (P[1].key_BT4_pressed == 0 && P[1].key_BT4_hold == 0) { P[1].key_BT4_pressed = 1; }
        }
        if (!P1_BT4) {
            if (P[1].key_BT4_released == 1) {
                P[1].key_BT4_released = 0;
                P[1].key_BT4_pressed = 0;
                P[1].key_BT4_hold = 0;
            }
            if (P[1].key_BT4_pressed > 0 || P[1].key_BT4_hold > 0) { P[1].key_BT4_released = 1; }
        }
        if (P[1].key_BT4_pressed == 0 && P[1].key_BT4_hold == 0 && P[1].key_BT4_released == 0) {
            P[1].key_BT4_status = 0;
        }
        if (P[1].key_BT4_pressed == 1) { P[1].key_BT4_status = 1; }
        if (P[1].key_BT4_hold == 1) { P[1].key_BT4_status = 2; }
        if (P[1].key_BT4_released == 1) { P[1].key_BT4_status = 3; }
        if (P1_BT5) {
            if (P[1].key_BT5_pressed == 1 && P[1].key_BT5_hold == 0) {
                P[1].key_BT5_hold = 1;
                P[1].key_BT5_pressed = 0;
            }
            if (P[1].key_BT5_pressed == 0 && P[1].key_BT5_hold == 0) { P[1].key_BT5_pressed = 1; }
        }
        if (!P1_BT5) {
            if (P[1].key_BT5_released == 1) {
                P[1].key_BT5_released = 0;
                P[1].key_BT5_pressed = 0;
                P[1].key_BT5_hold = 0;
            }
            if (P[1].key_BT5_pressed > 0 || P[1].key_BT5_hold > 0) { P[1].key_BT5_released = 1; }
        }
        if (P[1].key_BT5_pressed == 0 && P[1].key_BT5_hold == 0 && P[1].key_BT5_released == 0) {
            P[1].key_BT5_status = 0;
        }
        if (P[1].key_BT5_pressed == 1) { P[1].key_BT5_status = 1; }
        if (P[1].key_BT5_hold == 1) { P[1].key_BT5_status = 2; }
        if (P[1].key_BT5_released == 1) { P[1].key_BT5_status = 3; }
        if (P1_BT6) {
            if (P[1].key_BT6_pressed == 1 && P[1].key_BT6_hold == 0) {
                P[1].key_BT6_hold = 1;
                P[1].key_BT6_pressed = 0;
            }
            if (P[1].key_BT6_pressed == 0 && P[1].key_BT6_hold == 0) { P[1].key_BT6_pressed = 1; }
        }
        if (!P1_BT6) {
            if (P[1].key_BT6_released == 1) {
                P[1].key_BT6_released = 0;
                P[1].key_BT6_pressed = 0;
                P[1].key_BT6_hold = 0;
            }
            if (P[1].key_BT6_pressed > 0 || P[1].key_BT6_hold > 0) { P[1].key_BT6_released = 1; }
        }
        if (P[1].key_BT6_pressed == 0 && P[1].key_BT6_hold == 0 && P[1].key_BT6_released == 0) {
            P[1].key_BT6_status = 0;
        }
        if (P[1].key_BT6_pressed == 1) { P[1].key_BT6_status = 1; }
        if (P[1].key_BT6_hold == 1) { P[1].key_BT6_status = 2; }
        if (P[1].key_BT6_released == 1) { P[1].key_BT6_status = 3; }
        if (P1_SELECT) {
            if (P[1].key_SELECT_pressed == 1 && P[1].key_SELECT_hold == 0) {
                P[1].key_SELECT_hold = 1;
                P[1].key_SELECT_pressed = 0;
            }
            if (P[1].key_SELECT_pressed == 0 && P[1].key_SELECT_hold == 0) { P[1].key_SELECT_pressed = 1; }
        }
        if (!P1_SELECT) {
            if (P[1].key_SELECT_released == 1) {
                P[1].key_SELECT_released = 0;
                P[1].key_SELECT_pressed = 0;
                P[1].key_SELECT_hold = 0;
            }
            if (P[1].key_SELECT_pressed > 0 || P[1].key_SELECT_hold > 0) { P[1].key_SELECT_released = 1; }
        }
        if (P[1].key_SELECT_pressed == 0 && P[1].key_SELECT_hold == 0 && P[1].key_SELECT_released == 0) {
            P[1].key_SELECT_status = 0;
        }
        if (P[1].key_SELECT_pressed == 1) { P[1].key_SELECT_status = 1; }
        if (P[1].key_SELECT_hold == 1) { P[1].key_SELECT_status = 2; }
        if (P[1].key_SELECT_released == 1) { P[1].key_SELECT_status = 3; }
        if (P1_START) {
            if (P[1].key_START_pressed == 1 && P[1].key_START_hold == 0) {
                P[1].key_START_hold = 1;
                P[1].key_START_pressed = 0;
            }
            if (P[1].key_START_pressed == 0 && P[1].key_START_hold == 0) { P[1].key_START_pressed = 1; }
        }
        if (!P1_START) {
            if (P[1].key_START_released == 1) {
                P[1].key_START_released = 0;
                P[1].key_START_pressed = 0;
                P[1].key_START_hold = 0;
            }
            if (P[1].key_START_pressed > 0 || P[1].key_START_hold > 0) { P[1].key_START_released = 1; }
        }
        if (P[1].key_START_pressed == 0 && P[1].key_START_hold == 0 && P[1].key_START_released == 0) {
            P[1].key_START_status = 0;
        }
        if (P[1].key_START_pressed == 1) { P[1].key_START_status = 1; }
        if (P[1].key_START_hold == 1) { P[1].key_START_status = 2; }
        if (P[1].key_START_released == 1) { P[1].key_START_status = 3; }

        /*ABASTECE SLOTS*/
        if (P[1].key_UP_status == 1 || P[1].key_DOWN_status == 1 || P[1].key_LEFT_status == 1 || P[1].key_RIGHT_status
            == 1
            || P[1].key_BT1_status == 1 || P[1].key_BT2_status == 1 || P[1].key_BT3_status == 1
            || P[1].key_BT4_status == 1 || P[1].key_BT5_status == 1 || P[1].key_BT6_status == 1
            || P[1].key_SELECT_status == 1 || P[1].key_START_status == 1) {
            char StrBotoes[8] = "";
            int a = 0;
            int b = 0;
            int c = 0;
            int d = 0;
            int e = 0;
            int f = 0;
            int g = 0;
            int h = 0;
            MovSlots_P1();
            if (P[1].key_UP_status == 1 && P[1].key_LEFT_status == 0 && P[1].key_RIGHT_status == 0) {
                P[1].slot[1] = 8;
            }
            if (P[1].key_DOWN_status == 1 && P[1].key_LEFT_status == 0 && P[1].key_RIGHT_status == 0) {
                P[1].slot[1] = 2;
            }
            if (P[1].key_LEFT_status == 1 && P[1].key_DOWN_status == 0 && P[1].key_UP_status == 0) { P[1].slot[1] = 4; }
            if (P[1].key_RIGHT_status == 1 && P[1].key_DOWN_status == 0 && P[1].key_UP_status == 0) {
                P[1].slot[1] = 6;
            }
            if (P[1].key_BT1_status == 1) {
                P[1].bt_slot[1] = 1;
                a = 1;
            }
            if (P[1].key_BT2_status == 1) {
                P[1].bt_slot[1] = 2;
                b = 1;
            }
            if (P[1].key_BT3_status == 1) {
                P[1].bt_slot[1] = 3;
                c = 1;
            }
            if (P[1].key_BT4_status == 1) {
                P[1].bt_slot[1] = 4;
                d = 1;
            }
            if (P[1].key_BT5_status == 1) {
                P[1].bt_slot[1] = 5;
                e = 1;
            }
            if (P[1].key_BT6_status == 1) {
                P[1].bt_slot[1] = 6;
                f = 1;
            }
            if (P[1].key_SELECT_status == 1) {
                P[1].bt_slot[1] = 7;
                g = 1;
            }
            if (P[1].key_START_status == 1) {
                P[1].bt_slot[1] = 8;
                h = 1;
            }
            if (P[1].key_BT1_status == 1 || P[1].key_BT2_status == 1 || P[1].key_BT3_status == 1 || P[1].key_BT4_status
                == 1
                || P[1].key_BT5_status == 1 || P[1].key_BT6_status == 1 || P[1].key_SELECT_status == 1 || P[1].
                key_START_status == 1) {
                if (a == 1) { strcat(StrBotoes, "1"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
                if (b == 1) { strcat(StrBotoes, "2"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
                if (c == 1) { strcat(StrBotoes, "3"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
                if (d == 1) { strcat(StrBotoes, "4"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
                if (e == 1) { strcat(StrBotoes, "5"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
                if (f == 1) { strcat(StrBotoes, "6"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
                if (g == 1) { strcat(StrBotoes, "7"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
                if (h == 1) { strcat(StrBotoes, "8"); }
                P[1].bt_slot[1] = atoi(StrBotoes);
            }
            if (P[1].key_LEFT_status == 1 && P[1].key_UP_status == 1) { P[1].slot[1] = 7; }
            if (P[1].key_UP_status == 1 && P[1].key_RIGHT_status == 1) { P[1].slot[1] = 9; }
            if (P[1].key_RIGHT_status == 1 && P[1].key_DOWN_status == 1) { P[1].slot[1] = 3; }
            if (P[1].key_DOWN_status == 1 && P[1].key_LEFT_status == 1) { P[1].slot[1] = 1; }
            if (P[1].key_DOWN_status > 1 && P[1].key_RIGHT_status == 1) { P[1].slot[1] = 3; }
            if (P[1].key_RIGHT_status > 1 && P[1].key_DOWN_status == 1) { P[1].slot[1] = 3; }
            if (P[1].key_DOWN_status > 1 && P[1].key_LEFT_status == 1) { P[1].slot[1] = 1; }
            if (P[1].key_LEFT_status > 1 && P[1].key_DOWN_status == 1) { P[1].slot[1] = 1; }
            if (P[1].key_UP_status > 1 && P[1].key_RIGHT_status == 1) { P[1].slot[1] = 9; }
            if (P[1].key_RIGHT_status > 1 && P[1].key_UP_status == 1) { P[1].slot[1] = 9; }
            if (P[1].key_UP_status > 1 && P[1].key_LEFT_status == 1) { P[1].slot[1] = 7; }
            if (P[1].key_LEFT_status > 1 && P[1].key_UP_status == 1) { P[1].slot[1] = 7; }
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_DOWN_status == 3 && P[1].key_RIGHT_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 6;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_DOWN_status == 3 && P[1].key_LEFT_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 4;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_RIGHT_status == 3 && P[1].key_DOWN_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 2;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_LEFT_status == 3 && P[1].key_DOWN_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 2;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_UP_status == 3 && P[1].key_RIGHT_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 6;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_UP_status == 3 && P[1].key_LEFT_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 4;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_RIGHT_status == 3 && P[1].key_UP_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 8;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].key_LEFT_status == 3 && P[1].key_UP_status > 1) {
            MovSlots_P1();
            P[1].slot[1] = 8;
            P[1].t_slot[1] = P[1].ticks_4slot;
            P[1].ticks_4slot = 0;
        }
        if (P[1].t_slot[1] > 999) { P[1].t_slot[1] = 999; }
    }
}

void check_keys_P2() {
    if (desabilita_players == 0 && P[2].Pode_Mexer == 1) {
        if (P2_UP) {
            if (P[2].key_UP_pressed == 1 && P[2].key_UP_hold == 0) {
                P[2].key_UP_hold = 1;
                P[2].key_UP_pressed = 0;
            }
            if (P[2].key_UP_pressed == 0 && P[2].key_UP_hold == 0) { P[2].key_UP_pressed = 1; }
        }
        if (!P2_UP) {
            if (P[2].key_UP_released == 1) {
                P[2].key_UP_released = 0;
                P[2].key_UP_pressed = 0;
                P[2].key_UP_hold = 0;
            }
            if (P[2].key_UP_pressed > 0 || P[2].key_UP_hold > 0) { P[2].key_UP_released = 1; }
        }
        if (P[2].key_UP_pressed == 0 && P[2].key_UP_hold == 0 && P[2].key_UP_released == 0) { P[2].key_UP_status = 0; }
        if (P[2].key_UP_pressed == 1) { P[2].key_UP_status = 1; }
        if (P[2].key_UP_hold == 1) { P[2].key_UP_status = 2; }
        if (P[2].key_UP_released == 1) { P[2].key_UP_status = 3; }
        if (P2_DOWN) {
            if (P[2].key_DOWN_pressed == 1 && P[2].key_DOWN_hold == 0) {
                P[2].key_DOWN_hold = 1;
                P[2].key_DOWN_pressed = 0;
            }
            if (P[2].key_DOWN_pressed == 0 && P[2].key_DOWN_hold == 0) { P[2].key_DOWN_pressed = 1; }
        }
        if (!P2_DOWN) {
            if (P[2].key_DOWN_released == 1) {
                P[2].key_DOWN_released = 0;
                P[2].key_DOWN_pressed = 0;
                P[2].key_DOWN_hold = 0;
            }
            if (P[2].key_DOWN_pressed > 0 || P[2].key_DOWN_hold > 0) { P[2].key_DOWN_released = 1; }
        }
        if (P[2].key_DOWN_pressed == 0 && P[2].key_DOWN_hold == 0 && P[2].key_DOWN_released == 0) {
            P[2].key_DOWN_status = 0;
        }
        if (P[2].key_DOWN_pressed == 1) { P[2].key_DOWN_status = 1; }
        if (P[2].key_DOWN_hold == 1) { P[2].key_DOWN_status = 2; }
        if (P[2].key_DOWN_released == 1) { P[2].key_DOWN_status = 3; }
        if (P2_LEFT) {
            if (P[2].key_LEFT_pressed == 1 && P[2].key_LEFT_hold == 0) {
                P[2].key_LEFT_hold = 1;
                P[2].key_LEFT_pressed = 0;
            }
            if (P[2].key_LEFT_pressed == 0 && P[2].key_LEFT_hold == 0) { P[2].key_LEFT_pressed = 1; }
        }
        if (!P2_LEFT) {
            if (P[2].key_LEFT_released == 1) {
                P[2].key_LEFT_released = 0;
                P[2].key_LEFT_pressed = 0;
                P[2].key_LEFT_hold = 0;
            }
            if (P[2].key_LEFT_pressed > 0 || P[2].key_LEFT_hold > 0) { P[2].key_LEFT_released = 1; }
        }
        if (P[2].key_LEFT_pressed == 0 && P[2].key_LEFT_hold == 0 && P[2].key_LEFT_released == 0) {
            P[2].key_LEFT_status = 0;
        }
        if (P[2].key_LEFT_pressed == 1) { P[2].key_LEFT_status = 1; }
        if (P[2].key_LEFT_hold == 1) { P[2].key_LEFT_status = 2; }
        if (P[2].key_LEFT_released == 1) { P[2].key_LEFT_status = 3; }
        if (P2_RIGHT) {
            if (P[2].key_RIGHT_pressed == 1 && P[2].key_RIGHT_hold == 0) {
                P[2].key_RIGHT_hold = 1;
                P[2].key_RIGHT_pressed = 0;
            }
            if (P[2].key_RIGHT_pressed == 0 && P[2].key_RIGHT_hold == 0) { P[2].key_RIGHT_pressed = 1; }
        }
        if (!P2_RIGHT) {
            if (P[2].key_RIGHT_released == 1) {
                P[2].key_RIGHT_released = 0;
                P[2].key_RIGHT_pressed = 0;
                P[2].key_RIGHT_hold = 0;
            }
            if (P[2].key_RIGHT_pressed > 0 || P[2].key_RIGHT_hold > 0) { P[2].key_RIGHT_released = 1; }
        }
        if (P[2].key_RIGHT_pressed == 0 && P[2].key_RIGHT_hold == 0 && P[2].key_RIGHT_released == 0) {
            P[2].key_RIGHT_status = 0;
        }
        if (P[2].key_RIGHT_pressed == 1) { P[2].key_RIGHT_status = 1; }
        if (P[2].key_RIGHT_hold == 1) { P[2].key_RIGHT_status = 2; }
        if (P[2].key_RIGHT_released == 1) { P[2].key_RIGHT_status = 3; }
        if (P2_BT1) {
            if (P[2].key_BT1_pressed == 1 && P[2].key_BT1_hold == 0) {
                P[2].key_BT1_hold = 1;
                P[2].key_BT1_pressed = 0;
            }
            if (P[2].key_BT1_pressed == 0 && P[2].key_BT1_hold == 0) { P[2].key_BT1_pressed = 1; }
        }
        if (!P2_BT1) {
            if (P[2].key_BT1_released == 1) {
                P[2].key_BT1_released = 0;
                P[2].key_BT1_pressed = 0;
                P[2].key_BT1_hold = 0;
            }
            if (P[2].key_BT1_pressed > 0 || P[2].key_BT1_hold > 0) { P[2].key_BT1_released = 1; }
        }
        if (P[2].key_BT1_pressed == 0 && P[2].key_BT1_hold == 0 && P[2].key_BT1_released == 0) {
            P[2].key_BT1_status = 0;
        }
        if (P[2].key_BT1_pressed == 1) { P[2].key_BT1_status = 1; }
        if (P[2].key_BT1_hold == 1) { P[2].key_BT1_status = 2; }
        if (P[2].key_BT1_released == 1) { P[2].key_BT1_status = 3; }
        if (P2_BT2) {
            if (P[2].key_BT2_pressed == 1 && P[2].key_BT2_hold == 0) {
                P[2].key_BT2_hold = 1;
                P[2].key_BT2_pressed = 0;
            }
            if (P[2].key_BT2_pressed == 0 && P[2].key_BT2_hold == 0) { P[2].key_BT2_pressed = 1; }
        }
        if (!P2_BT2) {
            if (P[2].key_BT2_released == 1) {
                P[2].key_BT2_released = 0;
                P[2].key_BT2_pressed = 0;
                P[2].key_BT2_hold = 0;
            }
            if (P[2].key_BT2_pressed > 0 || P[2].key_BT2_hold > 0) { P[2].key_BT2_released = 1; }
        }
        if (P[2].key_BT2_pressed == 0 && P[2].key_BT2_hold == 0 && P[2].key_BT2_released == 0) {
            P[2].key_BT2_status = 0;
        }
        if (P[2].key_BT2_pressed == 1) { P[2].key_BT2_status = 1; }
        if (P[2].key_BT2_hold == 1) { P[2].key_BT2_status = 2; }
        if (P[2].key_BT2_released == 1) { P[2].key_BT2_status = 3; }
        if (P2_BT3) {
            if (P[2].key_BT3_pressed == 1 && P[2].key_BT3_hold == 0) {
                P[2].key_BT3_hold = 1;
                P[2].key_BT3_pressed = 0;
            }
            if (P[2].key_BT3_pressed == 0 && P[2].key_BT3_hold == 0) { P[2].key_BT3_pressed = 1; }
        }
        if (!P2_BT3) {
            if (P[2].key_BT3_released == 1) {
                P[2].key_BT3_released = 0;
                P[2].key_BT3_pressed = 0;
                P[2].key_BT3_hold = 0;
            }
            if (P[2].key_BT3_pressed > 0 || P[2].key_BT3_hold > 0) { P[2].key_BT3_released = 1; }
        }
        if (P[2].key_BT3_pressed == 0 && P[2].key_BT3_hold == 0 && P[2].key_BT3_released == 0) {
            P[2].key_BT3_status = 0;
        }
        if (P[2].key_BT3_pressed == 1) { P[2].key_BT3_status = 1; }
        if (P[2].key_BT3_hold == 1) { P[2].key_BT3_status = 2; }
        if (P[2].key_BT3_released == 1) { P[2].key_BT3_status = 3; }
        if (P2_BT4) {
            if (P[2].key_BT4_pressed == 1 && P[2].key_BT4_hold == 0) {
                P[2].key_BT4_hold = 1;
                P[2].key_BT4_pressed = 0;
            }
            if (P[2].key_BT4_pressed == 0 && P[2].key_BT4_hold == 0) { P[2].key_BT4_pressed = 1; }
        }
        if (!P2_BT4) {
            if (P[2].key_BT4_released == 1) {
                P[2].key_BT4_released = 0;
                P[2].key_BT4_pressed = 0;
                P[2].key_BT4_hold = 0;
            }
            if (P[2].key_BT4_pressed > 0 || P[2].key_BT4_hold > 0) { P[2].key_BT4_released = 1; }
        }
        if (P[2].key_BT4_pressed == 0 && P[2].key_BT4_hold == 0 && P[2].key_BT4_released == 0) {
            P[2].key_BT4_status = 0;
        }
        if (P[2].key_BT4_pressed == 1) { P[2].key_BT4_status = 1; }
        if (P[2].key_BT4_hold == 1) { P[2].key_BT4_status = 2; }
        if (P[2].key_BT4_released == 1) { P[2].key_BT4_status = 3; }
        if (P2_BT5) {
            if (P[2].key_BT5_pressed == 1 && P[2].key_BT5_hold == 0) {
                P[2].key_BT5_hold = 1;
                P[2].key_BT5_pressed = 0;
            }
            if (P[2].key_BT5_pressed == 0 && P[2].key_BT5_hold == 0) { P[2].key_BT5_pressed = 1; }
        }
        if (!P2_BT5) {
            if (P[2].key_BT5_released == 1) {
                P[2].key_BT5_released = 0;
                P[2].key_BT5_pressed = 0;
                P[2].key_BT5_hold = 0;
            }
            if (P[2].key_BT5_pressed > 0 || P[2].key_BT5_hold > 0) { P[2].key_BT5_released = 1; }
        }
        if (P[2].key_BT5_pressed == 0 && P[2].key_BT5_hold == 0 && P[2].key_BT5_released == 0) {
            P[2].key_BT5_status = 0;
        }
        if (P[2].key_BT5_pressed == 1) { P[2].key_BT5_status = 1; }
        if (P[2].key_BT5_hold == 1) { P[2].key_BT5_status = 2; }
        if (P[2].key_BT5_released == 1) { P[2].key_BT5_status = 3; }
        if (P2_BT6) {
            if (P[2].key_BT6_pressed == 1 && P[2].key_BT6_hold == 0) {
                P[2].key_BT6_hold = 1;
                P[2].key_BT6_pressed = 0;
            }
            if (P[2].key_BT6_pressed == 0 && P[2].key_BT6_hold == 0) { P[2].key_BT6_pressed = 1; }
        }
        if (!P2_BT6) {
            if (P[2].key_BT6_released == 1) {
                P[2].key_BT6_released = 0;
                P[2].key_BT6_pressed = 0;
                P[2].key_BT6_hold = 0;
            }
            if (P[2].key_BT6_pressed > 0 || P[2].key_BT6_hold > 0) { P[2].key_BT6_released = 1; }
        }
        if (P[2].key_BT6_pressed == 0 && P[2].key_BT6_hold == 0 && P[2].key_BT6_released == 0) {
            P[2].key_BT6_status = 0;
        }
        if (P[2].key_BT6_pressed == 1) { P[2].key_BT6_status = 1; }
        if (P[2].key_BT6_hold == 1) { P[2].key_BT6_status = 2; }
        if (P[2].key_BT6_released == 1) { P[2].key_BT6_status = 3; }
        if (P2_SELECT) {
            if (P[2].key_SELECT_pressed == 1 && P[2].key_SELECT_hold == 0) {
                P[2].key_SELECT_hold = 1;
                P[2].key_SELECT_pressed = 0;
            }
            if (P[2].key_SELECT_pressed == 0 && P[2].key_SELECT_hold == 0) { P[2].key_SELECT_pressed = 1; }
        }
        if (!P2_SELECT) {
            if (P[2].key_SELECT_released == 1) {
                P[2].key_SELECT_released = 0;
                P[2].key_SELECT_pressed = 0;
                P[2].key_SELECT_hold = 0;
            }
            if (P[2].key_SELECT_pressed > 0 || P[2].key_SELECT_hold > 0) { P[2].key_SELECT_released = 1; }
        }
        if (P[2].key_SELECT_pressed == 0 && P[2].key_SELECT_hold == 0 && P[2].key_SELECT_released == 0) {
            P[2].key_SELECT_status = 0;
        }
        if (P[2].key_SELECT_pressed == 1) { P[2].key_SELECT_status = 1; }
        if (P[2].key_SELECT_hold == 1) { P[2].key_SELECT_status = 2; }
        if (P[2].key_SELECT_released == 1) { P[2].key_SELECT_status = 3; }
        if (P2_START) {
            if (P[2].key_START_pressed == 1 && P[2].key_START_hold == 0) {
                P[2].key_START_hold = 1;
                P[2].key_START_pressed = 0;
            }
            if (P[2].key_START_pressed == 0 && P[2].key_START_hold == 0) { P[2].key_START_pressed = 1; }
        }
        if (!P2_START) {
            if (P[2].key_START_released == 1) {
                P[2].key_START_released = 0;
                P[2].key_START_pressed = 0;
                P[2].key_START_hold = 0;
            }
            if (P[2].key_START_pressed > 0 || P[2].key_START_hold > 0) { P[2].key_START_released = 1; }
        }
        if (P[2].key_START_pressed == 0 && P[2].key_START_hold == 0 && P[2].key_START_released == 0) {
            P[2].key_START_status = 0;
        }
        if (P[2].key_START_pressed == 1) { P[2].key_START_status = 1; }
        if (P[2].key_START_hold == 1) { P[2].key_START_status = 2; }
        if (P[2].key_START_released == 1) { P[2].key_START_status = 3; }

        /*ABASTECE SLOTS*/
        if (P[2].key_UP_status == 1 || P[2].key_DOWN_status == 1 || P[2].key_LEFT_status == 1 || P[2].key_RIGHT_status
            == 1
            || P[2].key_BT1_status == 1 || P[2].key_BT2_status == 1 || P[2].key_BT3_status == 1
            || P[2].key_BT4_status == 1 || P[2].key_BT5_status == 1 || P[2].key_BT6_status == 1
            || P[2].key_SELECT_status == 1 || P[2].key_START_status == 1) {
            char StrBotoes[8] = "";
            int a = 0;
            int b = 0;
            int c = 0;
            int d = 0;
            int e = 0;
            int f = 0;
            int g = 0;
            int h = 0;
            MovSlots_P2();
            if (P[2].key_UP_status == 1 && P[2].key_LEFT_status == 0 && P[2].key_RIGHT_status == 0) {
                P[2].slot[1] = 8;
            }
            if (P[2].key_DOWN_status == 1 && P[2].key_LEFT_status == 0 && P[2].key_RIGHT_status == 0) {
                P[2].slot[1] = 2;
            }
            if (P[2].key_LEFT_status == 1 && P[2].key_DOWN_status == 0 && P[2].key_UP_status == 0) { P[2].slot[1] = 4; }
            if (P[2].key_RIGHT_status == 1 && P[2].key_DOWN_status == 0 && P[2].key_UP_status == 0) {
                P[2].slot[1] = 6;
            }
            if (P[2].key_BT1_status == 1) {
                P[2].bt_slot[1] = 1;
                a = 1;
            }
            if (P[2].key_BT2_status == 1) {
                P[2].bt_slot[1] = 2;
                b = 1;
            }
            if (P[2].key_BT3_status == 1) {
                P[2].bt_slot[1] = 3;
                c = 1;
            }
            if (P[2].key_BT4_status == 1) {
                P[2].bt_slot[1] = 4;
                d = 1;
            }
            if (P[2].key_BT5_status == 1) {
                P[2].bt_slot[1] = 5;
                e = 1;
            }
            if (P[2].key_BT6_status == 1) {
                P[2].bt_slot[1] = 6;
                f = 1;
            }
            if (P[2].key_SELECT_status == 1) {
                P[2].bt_slot[1] = 7;
                g = 1;
            }
            if (P[2].key_START_status == 1) {
                P[2].bt_slot[1] = 8;
                h = 1;
            }
            if (P[2].key_BT1_status == 1 || P[2].key_BT2_status == 1 || P[2].key_BT3_status == 1 || P[2].key_BT4_status
                == 1
                || P[2].key_BT5_status == 1 || P[2].key_BT6_status == 1 || P[2].key_SELECT_status == 1 || P[2].
                key_START_status == 1) {
                if (a == 1) { strcat(StrBotoes, "1"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
                if (b == 1) { strcat(StrBotoes, "2"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
                if (c == 1) { strcat(StrBotoes, "3"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
                if (d == 1) { strcat(StrBotoes, "4"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
                if (e == 1) { strcat(StrBotoes, "5"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
                if (f == 1) { strcat(StrBotoes, "6"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
                if (g == 1) { strcat(StrBotoes, "7"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
                if (h == 1) { strcat(StrBotoes, "8"); }
                P[2].bt_slot[1] = atoi(StrBotoes);
            }
            if (P[2].key_LEFT_status == 1 && P[2].key_UP_status == 1) { P[2].slot[1] = 7; }
            if (P[2].key_UP_status == 1 && P[2].key_RIGHT_status == 1) { P[2].slot[1] = 9; }
            if (P[2].key_RIGHT_status == 1 && P[2].key_DOWN_status == 1) { P[2].slot[1] = 3; }
            if (P[2].key_DOWN_status == 1 && P[2].key_LEFT_status == 1) { P[2].slot[1] = 1; }
            if (P[2].key_DOWN_status > 1 && P[2].key_RIGHT_status == 1) { P[2].slot[1] = 3; }
            if (P[2].key_RIGHT_status > 1 && P[2].key_DOWN_status == 1) { P[2].slot[1] = 3; }
            if (P[2].key_DOWN_status > 1 && P[2].key_LEFT_status == 1) { P[2].slot[1] = 1; }
            if (P[2].key_LEFT_status > 1 && P[2].key_DOWN_status == 1) { P[2].slot[1] = 1; }
            if (P[2].key_UP_status > 1 && P[2].key_RIGHT_status == 1) { P[2].slot[1] = 9; }
            if (P[2].key_RIGHT_status > 1 && P[2].key_UP_status == 1) { P[2].slot[1] = 9; }
            if (P[2].key_UP_status > 1 && P[2].key_LEFT_status == 1) { P[2].slot[1] = 7; }
            if (P[2].key_LEFT_status > 1 && P[2].key_UP_status == 1) { P[2].slot[1] = 7; }
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_DOWN_status == 3 && P[2].key_RIGHT_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 6;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_DOWN_status == 3 && P[2].key_LEFT_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 4;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_RIGHT_status == 3 && P[2].key_DOWN_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 2;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_LEFT_status == 3 && P[2].key_DOWN_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 2;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_UP_status == 3 && P[2].key_RIGHT_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 6;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_UP_status == 3 && P[2].key_LEFT_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 4;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_RIGHT_status == 3 && P[2].key_UP_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 8;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].key_LEFT_status == 3 && P[2].key_UP_status > 1) {
            MovSlots_P2();
            P[2].slot[1] = 8;
            P[2].t_slot[1] = P[2].ticks_4slot;
            P[2].ticks_4slot = 0;
        }
        if (P[2].t_slot[1] > 999) { P[2].t_slot[1] = 999; }
    }
}
